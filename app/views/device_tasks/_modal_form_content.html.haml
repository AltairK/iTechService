= simple_form_for @device_task, html: { class: 'form-horizontal', remote: true } do |f|
  .modal-header
    %a.close{'data-dismiss' => 'modal', href: '#'}
      %i.icon-remove-sign
    %h3
      = @device_task.device.type_name

  .modal-body
    .alert.alert-info
      %strong= @device_task.task_name
      %br
      = @device_task.comment
    = f.input :user_comment, input_html: {rows: 3}
    = f.input :cost
    = f.input :done, disabled: @device_task.done

    - if can? :write_tech_notice, @device_task.device || Device
      = f.simple_fields_for :device do |ff|
        = ff.input :tech_notice, input_html: {rows: 3}

    - if can? :repair, @device_task.device || Device and @device_task.is_repair?
      %h4
        = DeviceTask.human_attribute_name :repair_tasks
        = link_to glyph(:plus) + t('device_tasks.add_repair_task').html_safe, choose_repair_services_path, remote: true, id: 'choose_repair_service_link', class: 'btn btn-success btn-small'
      - if f.object.errors.any?
        - f.object.errors[:base].each do |error|
          %p.text-error= error
      #repair_services_choose_form_container.well.well-small
      #repair_tasks= f.simple_fields_for(:repair_tasks) { |ff| render 'repair_task_fields', f: ff }

  .modal-footer
    = submit_button f
